import{r as f,h as S,p as C,q as V,o as s,g as M,w as h,b as e,j as N,a as l,u as d,c as o,k as v,t as m,F as u,f as p,e as T}from"./app-15dc6fea.js";import{_}from"./InputError-1f1c8eef.js";import{_ as j}from"./Modal-b6fb47e1.js";import{P as q}from"./PrimaryButton-29033063.js";import"./_plugin-vue_export-helper-c27b6911.js";const A={class:"p-6"},D=e("h2",{class:"text-md font-semibold text-gray-900 mt-2 mb-5"}," Import Product Data ",-1),E=e("p",{class:"mt-1 text-sm text-gray-600"}," The file must contain the following fields: code, name, description, price, stock, category_name, brand_name and status. This file must be in CSV or XLSX format. ",-1),L=["onSubmit"],U={class:"my-auto"},X={key:0},$=e("div",{class:"dots-loading items-center inline-block"},[e("div"),e("div"),e("div")],-1),z=e("p",{class:"ml-2 inline-block align-middle"},"Importing",-1),G=[$,z],H={key:1},J={key:0,class:"bg-gray-100 rounded-md p-5 max-h-96 mt-3 overflow-auto"},K={class:"text-md font-semibold text-gray-900"},O={class:"space-y-7 mt-10"},Q={class:"text-md font-semibold text-gray-900 mb-2"},R={class:"text-gray-600"},W={class:"px-8 mb-4"},Y={class:"text-md font-bold text-red-500 text-sm"},ne={__name:"ImportModal",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(g,{emit:x}){const i=f({}),t=f("pending");let n=null;const y=()=>{x("close")},r=S({file:null}),b=a=>{r.file=a.target.files[0]},w=()=>{t.value="pending",i.value={},r.post(route("admin.products.import"),{onSuccess:()=>{n=setInterval(()=>c(),3e3)},onError:()=>{t.value=""}})},I=async()=>{await c()||(n=setInterval(()=>c(),3e3))},c=async()=>{const a=await axios.get(route("admin.products.import.check"));return a.data.length===0?(clearInterval(n),t.value="",!0):a.data.status==="Completed"?(clearInterval(n),a.data.data.length===0?t.value="All products have been imported successfully without any errors":(t.value="The following products have not been imported due to errors",i.value=a.data.data),!0):a.data.status==="Failed"?(clearInterval(n),t.value="An error has occurred in the data export. Please try again later",!0):!1};return C(()=>{I()}),V(()=>{clearInterval(n)}),(a,Z)=>(s(),M(j,{show:g.show,onClose:y},{default:h(()=>[e("div",A,[D,E,e("form",{class:"flex justify-between bg-gray-100 rounded-md p-5 mt-7",onSubmit:N(w,["prevent"])},[e("div",U,[e("input",{id:"importFile",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",class:"file:p-2 file:border-none file:rounded-xl",name:"File Upload",type:"file",onInput:b},null,32),l(_,{message:d(r).errors.file,class:"mt-2"},null,8,["message"]),l(_,{message:d(r).errors.import,class:"mt-2"},null,8,["message"]),l(_,{message:d(r).errors.app,class:"mt-3"},null,8,["message"])]),t.value==="pending"?(s(),o("div",X,G)):(s(),o("div",H,[l(q,null,{default:h(()=>[v("Import")]),_:1})]))],40,L),t.value&&t.value!=="pending"?(s(),o("div",J,[e("h2",K,m(t.value),1),e("div",O,[(s(!0),o(u,null,p(i.value,(k,B)=>(s(),o("div",null,[e("h2",Q,[v(" Product code: "),e("span",R,m(B),1)]),(s(!0),o(u,null,p(k,F=>(s(),o("ul",W,[(s(!0),o(u,null,p(F,P=>(s(),o("li",Y,m(P),1))),256))]))),256))]))),256))])])):T("",!0)])]),_:1},8,["show"]))}};export{ne as default};
