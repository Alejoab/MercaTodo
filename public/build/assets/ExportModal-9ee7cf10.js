import{_ as d}from"./InputError-1f1c8eef.js";import{_ as h}from"./Modal-b6fb47e1.js";import{P as v}from"./PrimaryButton-29033063.js";import{h as y,r as w,p as b,q as k,o as l,g as E,w as u,b as t,a as c,k as q,c as p,e as I,u as m}from"./app-15dc6fea.js";import"./_plugin-vue_export-helper-c27b6911.js";const P={class:"p-6"},B=t("h2",{class:"text-md font-semibold text-gray-900 mt-2 mb-5"}," Export Product Data ",-1),C=t("p",{class:"mt-1 text-sm text-gray-600"}," Exporting products will generate a XLSX file with all the filter products in your store. ",-1),N={class:"flex justify-between mt-6"},V={key:0,class:"flex items-center"},M=t("div",{class:"dots-loading flex items-center"},[t("div"),t("div"),t("div")],-1),j=t("p",{class:"ml-2 inline-block align-middle"},"Generating",-1),D=[M,j],F=["href"],T={__name:"ExportModal",props:{show:{type:Boolean,required:!0},query:{type:Object,required:!0}},emits:["close"],setup(i,{emit:_}){const r=i,a=y({search:r.query.search,category:r.query.category,brand:r.query.brand}),f=()=>{_("close")},e=w("pending");let s=null;const x=()=>{e.value="pending",a.post(route("admin.products.export"),{onSuccess:()=>{s=setInterval(()=>n(),3e3)},onError:()=>{e.value=""}})},g=async()=>{await n()||(s=setInterval(()=>n(),3e3))},n=async()=>{const o=await axios.get(route("admin.products.exports.check"));return o.data.length===0?(clearInterval(s),e.value="",!0):o.data.status==="Completed"?(clearInterval(s),e.value=route("admin.products.export.download"),!0):o.data.status==="Failed"?(clearInterval(s),a.errors.export="Export failed. Please try again.",e.value="",!0):!1};return b(()=>{g()}),k(()=>{clearInterval(s)}),(o,S)=>(l(),E(h,{show:i.show,onClose:f},{default:u(()=>[t("div",P,[B,C,t("div",N,[c(v,{disabled:e.value==="pending",class:"disabled:bg-gray-500",onClick:x},{default:u(()=>[q("Export Products ")]),_:1},8,["disabled"]),e.value==="pending"?(l(),p("div",V,D)):e.value!==""?(l(),p("a",{key:1,href:e.value,class:"underline my-auto"},"Download Export",8,F)):I("",!0)]),c(d,{message:m(a).errors.export,class:"mt-3"},null,8,["message"]),c(d,{message:m(a).errors.app,class:"mt-3"},null,8,["message"])])]),_:1},8,["show"]))}};export{T as default};
